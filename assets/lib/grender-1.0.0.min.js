!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.grender=e():t.grender=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{AlterProgress:()=>y,Effect:()=>p,Grender:()=>u,Progress:()=>f,Renderable:()=>a,extend:()=>v});const n=function(){function t(t){this.isMouseDown=!1,this.element=t.element,this.subscribers=[],this.event={},this.DPR=t.DPR||window.devicePixelRatio}return t.prototype.setStyleSize=function(t,e){this.element.style.width=t+"px",this.element.style.height=e+"px"},t.prototype.setAttrSize=function(t,e){this.element.width=t,this.element.height=e},t.prototype.emitSubscribers=function(t,e){this.subscribers.forEach((function(n){return n(t,e)}))},t.prototype.subscribe=function(t){this.subscribers.push(t)},t}(),r=function(){function t(){this.children=[]}return t.prototype.add=function(t){var e=this,n=[].slice.call(arguments,0);return n.forEach((function(t){e.children.push(t)})),n},t.prototype.remove=function(t){for(var e in this.children)if(t===this.children[e])return this.children.splice(+e,1)[0]},t.prototype.get=function(t){for(var e=[],n=0,r=this.children;n<r.length;n++){var o=r[n];o.name&&o.name===t&&e.push(o)}return e},t}();var o,i=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});const s=function(t){function e(e){var n=t.call(this,e)||this;return n.scene=new r,n}return i(e,t),e.prototype.setSize=function(t,e){this.element.style.position="absolute",this.element.style.top=0,this.element.style.left=0,this.setAttrSize(t*this.DPR,e*this.DPR),this.setStyleSize(t,e)},e.prototype.clear=function(){var t=this.element.getContext("2d");return t.clearRect(0,0,t.canvas.width,t.canvas.height),this},e.prototype.render=function(){for(var t=this.element.getContext("2d"),e=0,n=this.scene.children;e<n.length;e++){var r=n[e];r.draw&&r.draw(t)}return this},e.prototype.reRender=function(){return this.clear(),this.render()},e.prototype.getElementsContainPoint=function(t){var e=this.element.getContext("2d");return this.scene.children.map((function(n){if(e.isPointInPath(n.path,t.x,t.y))return n})).filter((function(t){return t}))},e}(n);var h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const u=function(t){function e(e){var n=t.call(this,e)||this;return n.width=e.width||300,n.height=e.height||150,n.rendererManager=new r,n._eventHandler=n._eventHandler.bind(n),n.element.style.position="relative",n.setStyleSize(n.width,n.height),n.bounds=n.getBounds(),n._setInteractable(),n}return h(e,t),e.prototype.getScrollOffsets=function(){return{x:window.pageXOffset,y:window.pageYOffset}},e.prototype.getViewportSize=function(){var t=window;return{x:t.innerWidth,y:t.innerHeight}},e.prototype.getBounds=function(){var t=this.element.getBoundingClientRect(),e=t.left,n=t.top,r=t.width||t.right-t.left,o=t.height||t.bottom-t.top,i=e+r/2,s=n+o/2;return this.bounds={x:e,y:n,centerX:i,centerY:s,width:r,height:o}},e.prototype.addRenderer=function(t){var e=document.createElement("canvas"),n=new s({element:e,DPR:this.DPR});return n.setSize(this.bounds.width,this.bounds.height),n.name=t,this.element.appendChild(e),this.rendererManager.add(n)[0]},e.prototype._setInteractable=function(){var t=this.element;return t.addEventListener("mousedown",this._eventHandler),t.addEventListener("touchstart",this._eventHandler),t.addEventListener("mousemove",this._eventHandler),t.addEventListener("touchmove",this._eventHandler),t.addEventListener("mouseup",this._eventHandler),t.addEventListener("touchend",this._eventHandler),t.addEventListener("mouseover",this._eventHandler),t.addEventListener("mouseout",this._eventHandler),this},e.prototype._eventHandler=function(t){this.event={};var e=t.touches&&t.touches[0];switch(t.type){case"mousedown":this.event.interactor="mouse",this.isMouseDown=!0,this.event.type="touchstart",this.event.x=t.layerX*this.DPR,this.event.y=t.layerY*this.DPR;break;case"touchstart":this.event.interactor="finger",this.event.type="touchstart",this.event.x=(e.clientX-this.bounds.x)*this.DPR,this.event.y=(e.clientY-this.bounds.y)*this.DPR;break;case"mousemove":this.event.interactor="mouse",this.event.type="mousemove",this.isMouseDown&&(this.event.type="touchmove"),this.event.x=t.layerX*this.DPR,this.event.y=t.layerY*this.DPR;break;case"touchmove":this.event.interactor="finger",this.event.type="touchmove",this.event.x=(e.clientX-this.bounds.x)*this.DPR,this.event.y=(e.clientY-this.bounds.y)*this.DPR;break;case"mouseup":this.event.interactor="mouse",this.isMouseDown=!1,this.event.type="touchend";break;case"touchend":this.event.interactor="finger",this.event.type="touchend";case"mouseover":this.event.interactor="mouse",this.event.type="mouseover";break;case"mouseout":this.event.interactor="mouse",this.event.type="mouseout"}this.emitSubscribers(this.event,t)},e}(n),a=function(){function t(t){this.line=t&&t.line||1,this.fill=t&&t.fill||"#fff",this.stroke=t&&t.stroke||"#111",this.userData={}}return t.prototype.init=function(){},t.prototype.draw=function(t){},t}(),c=function(){function t(){this.initialized=!1}return t.generateEmptyFrames=function(t,e,n){for(var r=[],o=0;o<n;o++){var i=document.createElement("canvas");i.width=t,i.height=e,r.push(i)}return r},t.prototype.fromImage=function(e,n,r){var o=this,i=new Image;i.onload=function(){for(var e=i.width/n,s=i.height,h=t.generateEmptyFrames(e,s,n),u=0;u<n;u++)h[u].getContext("2d").drawImage(i,-u*e,0);o.setFrames(h),o.initialized=!0,r(o)},i.src=e},t.prototype.fromFrames=function(t){this.setFrames(t),this.initialized=!0},t.prototype.setFrames=function(t){this.frames=t,this.frameWidth=t[0].width,this.frameHeight=t[0].height,this.frameCounts=t.length,this.currentFrameIndex=0},t.prototype.updateFrames=function(e,n,r,o){var i=t.generateEmptyFrames(e,n,r);this.setFrames(i);for(var s=0;s<r;s++)o(s,this.frames[s].getContext("2d"))},t.prototype.drawFrame=function(t,e,n){t.drawImage(this.frames[this.currentFrameIndex],e,n),this.currentFrameIndex++,this.currentFrameIndex>=this.frameCounts&&(this.currentFrameIndex=0)},t.prototype.getSprite=function(){var t=document.createElement("canvas");t.width=this.frameWidth*this.frameCounts,t.height=this.frameHeight;for(var e=t.getContext("2d"),n=0;n<this.frameCounts;n++)e.drawImage(this.frames[n],this.frameWidth*n,0);return t},t}();var d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const p=function(t){function e(e){var n=t.call(this,e)||this;return n.keyframes=new c,n.frameCounts=e&&e.frameCounts||1,n.bounds={x:0,y:0,centerX:0,centerY:0,width:0,height:0},n}return d(e,t),e.prototype.locate=function(t,e,n){void 0===n&&(n=0),this.bounds.width=this.keyframes.frameWidth,this.bounds.height=this.keyframes.frameHeight;var r=this.bounds.width/2,o=this.bounds.height/2;switch(n){case 0:this.bounds.x=t-r,this.bounds.y=e-o;break;case 1:this.bounds.x=t,this.bounds.y=e;break;case 2:this.bounds.x=t-r,this.bounds.y=e;break;case 3:this.bounds.x=t-this.bounds.width,this.bounds.y=e;break;case 4:this.bounds.x=t-this.bounds.width,this.bounds.y=e-o;break;case 5:this.bounds.x=t-this.bounds.width,this.bounds.y=e-this.bounds.height;break;case 6:this.bounds.x=t-r,this.bounds.y=e-this.bounds.height;break;case 7:this.bounds.x=t,this.bounds.y=e-this.bounds.height;break;case 8:this.bounds.x=t,this.bounds.y=e-o}},e.prototype.draw=function(t){this.keyframes.initialized&&this.keyframes.drawFrame(t,this.bounds.x,this.bounds.y)},e}(a),f=function(){function t(t,e,n,r){this.value=this.startValue=t||0,this.endValue=e||1,this.t=n>=0&&n<=1?n:0,this.step=r||.1,this.valueLength=this.endValue-this.startValue}return t.prototype.getValue=function(t){return this.startValue+this.valueLength*t},t.prototype.drive=function(){var t=this.getValue(this.t);return this.t+=this.step,this.t>1&&(this.t=0),this.value=t},t}();var l=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const y=function(t){function e(e,n,r,o){return t.call(this,e,n,r,o)||this}return l(e,t),e.prototype.getValue=function(t){return t>=0&&t<.5?this.startValue+this.valueLength*t*2:this.startValue+this.valueLength*(2-2*t)},e}(f);function v(t,e){var n=function(n){t.call(this,n),e._constructor&&e._constructor.call(this,n)};function r(){}for(var o in r.prototype=t.prototype,(n.prototype=new r).constructor=n,e)n.prototype[o]=e[o];return n}return e})()}));